
<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<style>

body{
  max-width: 800px;
  margin: 0px auto;
}

section {
  background: white;
  font-family: monospace;
  height: 150px;
  opacity: .1;
}

section.active{
  opacity: 1;
}

#overlay{
  position: fixed;
  height: 150px;
  border-bottom: lightgray 1px solid;
  z-index: 1;
}

#overlay-space{
  height: 150px;
  content: ".";
  display: block;
  width: 800px;
}

circle{
  fill: steelblue;
  fill-opacity: 0;
  stroke: orange;
}

</style>

<div id='overlay'></div>
<div id='overlay-space'></div>

<section style="text-align:center;">
  
  intro about maps?

  <h1>Linear Scale</h1>
  Coloring maps can be tricky! Here is some advice on it. We start with an array of places, coloring them based on their locations:

      `placePaths.style('fill', function(d){ return color(x.value) })`

  `d3.scale.linear` uses linear interpolation to transform a value the domain into the range. This isn't a method
</section>

<section style="text-align:center;">
  <h1>Quantize</h1>
  some text about the top right
</section>

<section style="text-align:center;">
  <h1>Doesn't work great with outliers</h1>
  some text about the top right
</section>

<section style="text-align:center;">
  <h1>Quantile</h1>
  some text about the top right
</section>

<section style="text-align:center;">
  <h1>Might distort underlying date</h1>
  some text about the top right
</section>

<section style="text-align:center;">
  <h1>Janx natural breaks</h1>
  some text about the top right
</section>

<div id='bot-padding'></div>

<script src="d3.v3.js"></script>
<script src="gscroll.js"></script>
<script>

var width = 800,
    oHeight = 150,
    sHeight = 100,
    sWidth = 150,
    colors = ["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],
    scroll = gscroll(),
    n = 150,
    ƒ = function(s){ return function(o){ return o[s] } };

circleArrays = []
circleArrays[0] = d3.range(n).map(function(){
  return Math.random()*sHeight })
circleArrays[1] = d3.range(n).map(function(d){
  return sHeight/n*d + Math.random()*40 - 20 })
circleArrays[2] = d3.range(n).map(function(d){
  return sHeight/n*d + Math.random()*20 - 10 })
circleArrays[3] = d3.range(n).map(function(d){
  return sHeight - sHeight/n*d + Math.random()*40 })

var rectAttrs = []
rectAttrs.push(function(selection){
  selection
    .attr('x', 0)
    .attr('width', sWidth)
    .attr('y', function(d, i){ return (colors.length - 1 - i)*sHeight/colors.length })
    .attr('height', sHeight/colors.length)
})
rectAttrs.push(function(selection){
  selection
    .attr('x', 0)
    .attr('width', sWidth)
    .attr('y', function(d, i){ return (colors.length - 1 - i)*sHeight/colors.length })
    .attr('height', sHeight/colors.length)
})
rectAttrs.push(function(selection){
  selection
    .attr('x', function(d, i){ return i*sWidth/colors.length })
    .attr('width', sWidth/colors.length)
    .attr('y', 0)
    .attr('height', sHeight)
})


d3.select('#bot-padding')
    .style('height', window.innerHeight - oHeight - sHeight - 100 + 'px')


var svg = d3.select('#overlay')
  .append('svg')
    .attr({width: 800, height: oHeight})

var gradScale = d3.scale.linear()
    .domain([0, colors.length])
    .range([colors[0], colors[colors.length - 1]])
svg.append('defs').selectAll('linearGradient')
    .data(colors).enter()
  .append('linearGradient')
    .attr({x1: 0, x2: 0, y1: 1, y2: 0})
    .each(function(d, i){
      d3.select(this).attr('id', 'lg' + i)
        .append('stop')
          .datum({gradColor: gradScale(i), discColor: colors[i]})
          .attr({'stop-color': gradScale(i), offset: '0%'})
      d3.select(this).append('stop')
          .attr({'stop-color': gradScale(i + 1), offset: '100%'})
          .datum({gradColor: gradScale(i + 1), discColor: colors[i]})
    })


svg.append('rect').attr({width: width, height: oHeight})
    .style('fill', 'rgb(250, 248, 248)')


var scatterG = svg.append('g')
    .attr('transform', 'translate(' + 50 + ',' + (oHeight - sHeight)/2 + ')')

var rects = scatterG.selectAll('rect')
    .data(colors).enter()
  .append('rect')
    .attr('fill', function(d, i){ return 'url(#lg' + i + ')' })
    .call(rectAttrs[1])

var circles = scatterG.selectAll('circle')
    .data(circleArrays[0]).enter()
  .append('circle')
    .attr('r', 2)
    .attr('cx', function(d, i){ return i })
    .attr('cy', function(d, i){ return d })

scroll.on('active', function(i){

  circles.data(circleArrays[i])
    .transition().duration(1000)
      .attr('cy', function(d){ return d })

  rects
    .transition().duration(1000)
      .call(rectAttrs[i])

  svg.selectAll('stop')
    .transition().duration(1000)
      .attr('stop-color', ƒ(i ? 'discColor' : 'gradColor'))

})

</script>